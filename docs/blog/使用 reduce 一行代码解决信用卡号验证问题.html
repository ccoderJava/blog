<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 reduce 一行代码解决信用卡号验证问题 | 洋子的自留地</title>
    <meta name="description" content="互联网的搬运工">
    <meta name="generator" content="VuePress 1.3.1">
    <script src="https://tajs.qq.com/stats?sId=66403914" charset="UTF-8"></script>
    
    <link rel="preload" href="/blog/assets/css/0.styles.a74cf8e1.css" as="style"><link rel="preload" href="/blog/assets/js/app.b4cbe1f2.js" as="script"><link rel="preload" href="/blog/assets/js/2.c61d148f.js" as="script"><link rel="preload" href="/blog/assets/js/10.592022ff.js" as="script"><link rel="prefetch" href="/blog/assets/js/11.5ab1d407.js"><link rel="prefetch" href="/blog/assets/js/12.77f4ecff.js"><link rel="prefetch" href="/blog/assets/js/13.24330948.js"><link rel="prefetch" href="/blog/assets/js/14.045c1e3b.js"><link rel="prefetch" href="/blog/assets/js/15.9ec6e314.js"><link rel="prefetch" href="/blog/assets/js/16.6623cce4.js"><link rel="prefetch" href="/blog/assets/js/17.084f7132.js"><link rel="prefetch" href="/blog/assets/js/3.3f90654c.js"><link rel="prefetch" href="/blog/assets/js/4.f4aba7c8.js"><link rel="prefetch" href="/blog/assets/js/5.2d3cdf01.js"><link rel="prefetch" href="/blog/assets/js/6.14b40120.js"><link rel="prefetch" href="/blog/assets/js/7.581a3d40.js"><link rel="prefetch" href="/blog/assets/js/8.606f31f0.js"><link rel="prefetch" href="/blog/assets/js/9.1534dab6.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.a74cf8e1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">洋子的自留地</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div> <a href="https://github.com/purocean/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div> <a href="https://github.com/purocean/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>使用 reduce 一行代码解决信用卡号验证问题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/%E4%BD%BF%E7%94%A8%20reduce%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E4%BF%A1%E7%94%A8%E5%8D%A1%E5%8F%B7%E9%AA%8C%E8%AF%81%E9%97%AE%E9%A2%98.html#背景" class="sidebar-link">背景</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/blog/%E4%BD%BF%E7%94%A8%20reduce%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E4%BF%A1%E7%94%A8%E5%8D%A1%E5%8F%B7%E9%AA%8C%E8%AF%81%E9%97%AE%E9%A2%98.html#java-实现" class="sidebar-link">JAVA 实现</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/blog/%E4%BD%BF%E7%94%A8%20reduce%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E4%BF%A1%E7%94%A8%E5%8D%A1%E5%8F%B7%E9%AA%8C%E8%AF%81%E9%97%AE%E9%A2%98.html#使用-javascript-的-reduce-实现" class="sidebar-link">使用 Javascript 的 reduce 实现</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/blog/%E4%BD%BF%E7%94%A8%20reduce%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E4%BF%A1%E7%94%A8%E5%8D%A1%E5%8F%B7%E9%AA%8C%E8%AF%81%E9%97%AE%E9%A2%98.html#参考" class="sidebar-link">参考</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="使用-reduce-一行代码解决信用卡号验证问题"><a href="#使用-reduce-一行代码解决信用卡号验证问题" class="header-anchor">#</a> 使用 reduce 一行代码解决信用卡号验证问题</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>女票 JAVA 课程有一道作业题，验证信用卡号是否合法。</p> <blockquote><p>实验作业longer 9月30号 星期五 12:09
实验1:验证信用卡号码
Lab Project: Validating Credit Cards
 Problem Description:
Credit card numbers follow certain patterns. A credit card number must have between 13 and 16 digits. It must start with:
4 for Visa cards
5 for Master cards
37 for American Express cards
6 for Discover cards
In 1954, Hans Luhn of IBM proposed an algorithm for validating credit card numbers. The algorithm is useful to determine if a card number is entered correctly or if a credit card is scanned correctly by a scanner. Almost all credit card numbers are generated following this validity check, commonly known as the Luhn check or the Mod 10 check, which can be described as follows (for illustration, consider the card number 4388576018402626):
1. Double every second digit from right to left. If doubling of a digit results in a two-digit number, add up the two digits to get a single-digit number.
2 * 2 = 4
2 * 2 = 4
4 * 2 = 8
1 * 2 = 2
6 * 2 = 12 (1 + 2 = 3)
5 * 2 = 10 (1 + 0 = 1)
8 * 2 = 16 (1 + 6 = 7)
4 * 2 = 8
2. Now add all single-digit numbers from Step 1. 
4 + 4 + 8 + 2 + 3 + 1 + 7 + 8 = 37
3. Add all digits in the odd places from right to left in the card number.
   6 + 6 + 0 + 8 + 0 + 7 + 8 + 3 = 38
4. Sum the results from Step 2 and Step 3.
37 + 38 = 75
5. If the result from Step 4 is divisible by 10, the card number is valid; otherwise, it is invalid. For example, the number 4388576018402626 is invalid, but the number 4388576018410707 is valid.
Write a program that prompts the user to enter a credit card number as a long integer. Display whether the number is valid or invalid.</p></blockquote> <p>两个测试用例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>不合法卡号:
4388576018402626
合法卡号:
4388576018410707
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="java-实现"><a href="#java-实现" class="header-anchor">#</a> JAVA 实现</h2> <p>既然是作业，先用 JAVA 写了。我 JAVA 也不是太熟，就这样。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import java.util.*;

public class Validating {
    public static void main(String[] args) {
        while (!xiaomiaomiao()) {
            System.out.println(&quot;The number you input is invalid. Please try again.&quot;);
        }

        System.out.println(&quot;The number you input is valid.&quot;);
    }

    public static boolean xiaomiaomiao() {
        System.out.println(&quot;Input your card number:&quot;);
        String numStr = (new Scanner(System.in)).next();

        int count = 0;
        int sum = 0;
        for (int i = numStr.length() - 1; i &gt;= 0; --i) {
            // 判断字符合法
            int ascii = (int) numStr.charAt(i);
            if (ascii &lt; 48 || 57 &lt; ascii) {
                System.out.println(&quot;Input must be numeric.&quot;);
                return false;
            }

            // 求和
            int num = ascii - 48;
            if ((numStr.length() - i) % 2 == 0) {
                int tmp = num * 2;
                sum += tmp &gt; 9 ? tmp - 9 : tmp;
            } else {
                sum += num;
            }

            ++count;
        }

        if (count &lt; 13 || 16 &lt; count) {
            System.out.println(&quot;13 ~ 16.&quot;);

            return false;
        }

        return (sum % 10 == 0);
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="使用-javascript-的-reduce-实现"><a href="#使用-javascript-的-reduce-实现" class="header-anchor">#</a> 使用 Javascript 的 reduce 实现</h2> <p>先上一张图
<img src="/blog/assets/img/61d072e6.61d072e6.png" alt="">
很形象的描述了 Reduce 的作用是吧。
然后代码实现，一句话解决（未校验号码长度）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[...'4388576018410707'].reduceRight((previousValue, currentValue, index, array) =&gt; {if ((array.length-index) % 2) {return previousValue - -currentValue} else {return previousValue - -(currentValue*2 &gt; 9 ? currentValue*2-9 : currentValue*2)} }) % 10 ? '验证失败' : '验证成功'
&quot;验证成功&quot;
[...'4388576018402626'].reduceRight((previousValue, currentValue, index, array) =&gt; {if ((array.length-index) % 2) {return previousValue - -currentValue} else {return previousValue - -(currentValue*2 &gt; 9 ? currentValue*2-9 : currentValue*2)} }) % 10 ? '验证失败' : '验证成功'
&quot;验证失败&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/blog/assets/img/5959a679.5959a679.png" alt=""></p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ol><li><a href="http://es6.ruanyifeng.com/?search=reduce&amp;x=0&amp;y=0#docs/destructuring" target="_blank" rel="noopener noreferrer">http://es6.ruanyifeng.com/?search=reduce&amp;x=0&amp;y=0#docs/destructuring<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/3/2019, 10:33:40 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.b4cbe1f2.js" defer></script><script src="/blog/assets/js/2.c61d148f.js" defer></script><script src="/blog/assets/js/10.592022ff.js" defer></script>
  </body>
</html>
